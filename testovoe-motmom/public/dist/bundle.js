!function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(i,a,function(t){return e[t]}.bind(null,a));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t){const n=e=>new Promise((t,n)=>{$.ajax({type:"POST",url:"/updateevents",data:{events:JSON.stringify(e)},success:e=>{t(e)}})});e.exports={createNewDomElement:e=>{let{element:t,inputType:n,className:i,id:a,text:r}=e,m=document.createElement(t);if(i&&m.setAttribute("class",i),a&&m.setAttribute("id",a),n&&m.setAttribute("type",n),r){let e=document.createTextNode(r);m.appendChild(e)}return m},updateEventsJSON:n,deleteEvent:(e,t)=>{t=t.filter(t=>parseInt(t.id)!==e),n(t).then(n=>{document.getElementById("main-ul").removeChild(document.getElementById(`main-ul_item*${e}`)),document.getElementById("modify-events-form").querySelector("li.modify-events-form_ul_item.active.disabled")&&(document.getElementById("modify-events-form").querySelector("li.modify-events-form_ul_item.active.disabled").className=document.getElementById("modify-events-form").querySelector("li.modify-events-form_ul_item.active.disabled").className.replace(" active disabled","")),window.renderEvents(t)})},getActiveEvents:()=>{return Array.from(document.getElementsByClassName("event-item")).filter(e=>e.querySelector("input[type=checkbox]").checked)},getEventsElements:()=>{return Array.from(document.getElementsByClassName("event-item"))},getModifyEventsTimeElements:()=>{return Array.from(document.getElementsByClassName("modify-events-form_ul_item"))},sortEventsByTime:e=>{let t=e.slice();return t.sort((e,t)=>60*parseInt(e.time.split(":")[0])+parseInt(e.time.split(":")[1])>=60*parseInt(t.time.split(":")[0])+parseInt(t.time.split(":")[1])?1:-1),t},sortEventsByID:e=>{let t=e.slice();return t.sort((e,t)=>parseInt(e.id)>=parseInt(t.id)?1:-1),t},addNewEvent:(e,t)=>{t.push(e),n(t).then(e=>{document.getElementById("add-event-form_event-name-input").value="",document.getElementById("add-event-form_event-time-input").value="",window.renderEvents(t)})},updateEventsById:(e,t,i)=>{i=i.map(n=>(-1!==e.indexOf(parseInt(n.id))&&(n.time=t),n)),n(i).then(t=>{window.renderEvents(i,e)})},loadData:()=>new Promise(e=>{$.ajax({type:"GET",url:"/getevents",success:t=>{e(JSON.parse(t).events)}})})}},function(e,t){let n=document.getElementById("modify-events_options_start-time"),i=document.getElementById("modify-events_options_end-time"),a=document.getElementById("modify-events_options_period");e.exports={main_events_arr:void 0,beginTime:"08:00",finalTime:"16:00",periodTime:30,modifyStartTime_input:n,modifyEndTime_input:i,modifyPeriod_input:a,form_switching:!1}},function(e,t,n){const i=n(0),a=n(1),r=()=>{document.getElementById("modify-events-form_ul").innerHTML="";let e=60*parseInt(a.beginTime.split(":")[0])+parseInt(a.beginTime.split(":")[1]),t=60*parseInt(a.finalTime.split(":")[0])+parseInt(a.finalTime.split(":")[1]),n=Math.floor((t-e)/a.periodTime);for(let t=0;t<=n;t++){let n=e+a.periodTime*t,r=Math.floor(n/60);if(!(r<=23))continue;let m=`${r=r>=10?r:`0${r}`}:${n%60>=10?n%60:`0${n%60}`}`;const l=e=>{let t=!0;if(i.getActiveEvents().length>0){for(let n of i.getActiveEvents())if(e!==n.querySelector("span.event-item_time").innerHTML){t=!1;break}}else t=!1;return t};let d=i.createNewDomElement({element:"li",className:l(m)?"modify-events-form_ul_item active disabled":"modify-events-form_ul_item",text:m});document.getElementById("modify-events-form_ul").appendChild(d),d.addEventListener("click",e=>{let t=i.getActiveEvents().map(e=>parseInt(e.id.split("*")[1]));if(i.getActiveEvents().length>0&&!e.target.className.includes(" disabled")){if(i.updateEventsById(t,e.target.innerHTML,a.main_events_arr),e.target.parentElement.querySelector("li.modify-events-form_ul_item.active")){let t=e.target.parentElement.querySelector("li.modify-events-form_ul_item.active");t.className=t.className.replace(" active",""),t.className=t.className.replace(" disabled","")}e.target.className=e.target.className+" active disabled"}else if(0===i.getActiveEvents().length&&!e.target.className.includes(" disabled")){if(e.target.parentElement.querySelector("li.modify-events-form_ul_item.active")){let t=e.target.parentElement.querySelector("li.modify-events-form_ul_item.active");t.className=t.className.replace(" active","")}e.target.className=e.target.className+" active",i.getEventsElements().forEach(t=>{t.querySelector("span.event-item_time").innerHTML===e.target.innerHTML&&(t.className=t.className+" active",t.querySelector("input[type=checkbox]").checked=!0)}),i.getActiveEvents().length>0&&(e.target.className=e.target.className+" disabled")}})}};r(),e.exports={initModifyEventsForm:r}},function(e,t,n){const i=n(0),a=(n(4),n(5)),r=n(6),m=n(1);i.loadData().then(e=>{m.main_events_arr=e,window.renderEvents(e),a.initListeners(),r.initListeners()})},function(e,t,n){const i=n(0),a=n(1),r=n(2).initModifyEventsForm,m=(e,...t)=>{let n=i.createNewDomElement({element:"input",inputType:"checkbox",className:"event-item_checkbox"}),m=i.createNewDomElement({element:"span",className:"event-item_time",text:e.time}),l=i.createNewDomElement({element:"span",className:"event-item_text",text:e.name}),d=i.createNewDomElement({element:"button",className:"event-item_delete-btn",text:"x"}),s="";t[0]&&-1!==t[0].indexOf(parseInt(e.id))?(s="main-ul_item event-item active",n.checked=!0):s="main-ul_item event-item";let o=i.createNewDomElement({element:"li",className:s,id:`main-ul_item*${e.id}`});o.appendChild(n),o.appendChild(m),o.appendChild(l),o.appendChild(d),document.getElementById("main-ul").appendChild(o),o.addEventListener("click",e=>{if(e.target.children.length>0){let t=e.target.querySelector("input[type=checkbox]");t.checked=!t.checked;let n=e.target,i=" active";n.className=n.className.includes(i)?n.className.replace(i,""):n.className+i,r()}else{let t=e.target.parentElement.querySelector("input[type=checkbox]");e.target!=t&&(t.checked=!t.checked);let n=e.target.parentElement,i=" active";n.className=n.className.includes(i)?n.className.replace(i,""):n.className+i,r()}}),d.addEventListener("click",e=>{let t=parseInt(e.target.parentElement.id.split("*")[1]),n=e.target.parentElement.querySelector(".event-item_time").innerHTML,r=e.target.parentElement.querySelector(".event-item_text").innerHTML;confirm(`Удалить "${`${n} - ${r}`}"?`)&&i.deleteEvent(t,a.main_events_arr),e.stopPropagation()})};window.renderEvents=((e,...t)=>{document.getElementById("main-ul").innerHTML="",e=i.sortEventsByTime(e);for(let n of e)m(n,t[0])}),e.exports={createNewEventElement:m}},function(e,t,n){const i=n(0),a=n(1),r=(e,t,n)=>{a.form_switching=!0,$(t).animate({left:`-=${n}px`}),$(e).animate({left:`-=${n}px`},()=>{a.form_switching=!1})};e.exports={initListeners:()=>{document.getElementById("events-add_button").addEventListener("click",e=>{let t=document.getElementById("add-event-form_container"),n=document.getElementById("events-form_wrapper");a.form_switching||r(n,t,t.offsetLeft)}),document.getElementById("add-event-form").addEventListener("submit",e=>{e.preventDefault();let t=i.sortEventsByID(a.main_events_arr),n=parseInt(t[t.length-1].id)+1,m=document.getElementById("add-event-form_event-name-input"),l=document.getElementById("add-event-form_event-time-input"),d={id:n,name:m.value,time:l.value};if(m.value&&l.value)if(/\d{2}:\d{2}/.test(l.value)&&parseInt(l.value.split(":")[0])<=23&&parseInt(l.value.split(":")[1])<=59){i.addNewEvent(d,a.main_events_arr);let e=document.getElementById("add-event-form_container"),t=document.getElementById("events-form_wrapper");r(t,e,t.offsetLeft)}else l.focus();else m.value?l.value||l.focus():m.focus()}),document.getElementById("add-event-form_cancel-btn").addEventListener("click",e=>{e.preventDefault();let t=document.getElementById("add-event-form_container"),n=document.getElementById("events-form_wrapper");a.form_switching||r(n,t,n.offsetLeft),document.getElementById("add-event-form_event-name-input").value="",document.getElementById("add-event-form_event-time-input").value=""})}}},function(e,t,n){n(0);const i=n(1),a=n(2).initModifyEventsForm;i.modifyStartTime_input.value=i.beginTime.split(":")[0],i.modifyEndTime_input.value=i.finalTime.split(":")[0],i.modifyPeriod_input.value=i.periodTime,document.getElementById("modify-events_options-info_start-time").children[1].innerHTML=i.beginTime,document.getElementById("modify-events_options-info_end-time").children[1].innerHTML=i.finalTime,document.getElementById("modify-events_options-info_period").children[1].innerHTML=i.periodTime;e.exports={initListeners:()=>{i.modifyStartTime_input.addEventListener("input",e=>{let t=e.target.value;document.getElementById("modify-events_options-info_start-time").children[1].innerHTML=t>=10?`${t}:00`:`0${t}:00`}),i.modifyStartTime_input.addEventListener("change",e=>{i.beginTime=e.target.value>=10?`${e.target.value}:00`:`0${e.target.value}:00`,a()}),i.modifyEndTime_input.addEventListener("input",e=>{let t=e.target.value;document.getElementById("modify-events_options-info_end-time").children[1].innerHTML=t>=10?`${t}:00`:`0${t}:00`}),i.modifyEndTime_input.addEventListener("change",e=>{i.finalTime=e.target.value>=10?`${e.target.value}:00`:`0${e.target.value}:00`,a()}),i.modifyPeriod_input.addEventListener("input",e=>{let t=e.target.value;document.getElementById("modify-events_options-info_period").children[1].innerHTML=t>=10?`${t}`:`0${t}`}),i.modifyPeriod_input.addEventListener("change",e=>{i.periodTime=e.target.value,a()})}}}]);